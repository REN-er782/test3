
import streamlit as st

st.set_page_config(page_title="扶養控除 判定フロー", layout="wide")

st.title("🧾 扶養控除 判定フロー（配偶者・親族含む完全版）")

st.markdown("""---

### 【配偶者に関する判定】""")

with st.expander("STEP 1：配偶者か？"):
    is_spouse = st.radio("対象者は配偶者ですか？", ["はい", "いいえ"])
    if is_spouse == "いいえ":
        st.warning("▶ 配偶者控除の対象外（親族の判定へ進んでください）")

if is_spouse == "はい":
    st.subheader("STEP 2：本人年収は1,000万円以上？")
    income_high = st.radio("本人の年収は？", ["1,000万円未満", "1,000万円以上"])

    st.subheader("STEP 3 or 4：配偶者の収入")
    income_range = st.selectbox("配偶者の年収（おおよそ）", [
        "～123万円",
        "123万円超～130万円",
        "130万円超～160万円",
        "160万円超～201万円",
        "201万円超"
    ])

    if income_high == "1,000万円以上":
        st.info("※ 控除は受けられません。以下は目安としてご確認ください。")
        result_map = {
            "～123万円":  ("❌ 控除対象外", "✅ 健保の被扶養者対象", "✅ 家族手当支給"),
            "123万円超～130万円": ("❌ 控除対象外", "✅ 健保の被扶養者対象", "✅ 家族手当支給"),
            "130万円超～160万円": ("❌ 控除対象外", "❌ 健保の被扶養者対象外", "✅ 家族手当支給"),
            "160万円超～201万円": ("❌ 控除対象外", "❌ 健保の被扶養者対象外", "❌ 家族手当不支給"),
            "201万円超":  ("❌ 控除対象外", "❌ 健保の被扶養者対象外", "❌ 家族手当不支給"),
        }
    else:
        result_map = {
            "～123万円":  ("✅ 配偶者控除対象", "✅ 健保の被扶養者対象", "✅ 家族手当支給"),
            "123万円超～130万円": ("✅ 配偶者特別控除対象", "✅ 健保の被扶養者対象", "✅ 家族手当支給"),
            "130万円超～160万円": ("✅ 配偶者特別控除対象", "❌ 健保の被扶養者対象外", "✅ 家族手当支給"),
            "160万円超～201万円": ("✅ 配偶者特別控除対象（段階的）", "❌ 健保の被扶養者対象外", "❌ 家族手当不支給"),
            "201万円超":  ("✅ 配偶者特別控除対象（段階的）", "❌ 健保の被扶養者対象外", "❌ 家族手当不支給"),
        }

    if income_range in result_map:
        st.success(f"""
**判定結果：**

- 控除：{result_map[income_range][0]}
- 健康保険：{result_map[income_range][1]}
- 家族手当：{result_map[income_range][2]}
        """)

st.markdown("""---

### 【親族・子どもに関する判定（ダイジェスト版）】

（※このパートは次回バージョンでUI化予定）""")

